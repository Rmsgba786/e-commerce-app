<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple E-Commerce App</title>
    <!-- Use Tailwind CSS for a modern and responsive design -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .card {
            background: white;
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            max-width: 28rem;
            width: 100%;
            text-align: center;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 1.5rem;
            text-align: center;
            max-width: 24rem;
            width: 100%;
        }
    </style>
</head>
<body>

    <!-- Main container for the entire application -->
    <div class="container">

        <!-- All application sections are hidden by default, and will be shown by JavaScript -->
        
        <!-- ======================= -->
        <!-- Landing Page Section -->
        <!-- ======================= -->
        <div id="landing-page" class="card">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Welcome to the Marketplace</h1>
            <p class="text-gray-600 mb-8">Please select your role to continue.</p>
            <div class="flex flex-col space-y-4">
                <button onclick="showSellerLogin()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300 transform hover:scale-105">
                    Seller
                </button>
                <button onclick="showBuyerPage()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300 transform hover:scale-105">
                    Buyer
                </button>
            </div>
        </div>

        <!-- ======================= -->
        <!-- Seller Login Section -->
        <!-- ======================= -->
        <div id="seller-login" class="card hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Seller Login</h2>
            <div class="space-y-4">
                <input type="email" id="seller-email" placeholder="Email" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <input type="password" id="seller-password" placeholder="Password" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <p id="login-error" class="text-red-500 text-sm hidden">Invalid email or password.</p>
                <button onclick="handleSellerLogin()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300">
                    Start Selling
                </button>
            </div>
        </div>

        <!-- ======================= -->
        <!-- Seller Dashboard Section -->
        <!-- ======================= -->
        <div id="seller-dashboard" class="card hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Seller Dashboard</h2>
            <div id="seller-pre-publish" class="space-y-4">
                <p class="text-gray-600">Add a product to get started.</p>
                <!-- This input simulates the 'Add data' button and file explorer -->
                <input type="file" id="product-file" accept=".txt,.csv,.xlsx,.xls,.pbix" class="w-full text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
                
                <!-- Set Price Section -->
                <div class="mt-6">
                    <label for="product-price" class="block text-left text-gray-700 font-semibold mb-2">Set Price (USD)</label>
                    <div class="relative rounded-md shadow-sm">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500">$</span>
                        </div>
                        <input type="text" id="product-price" oninput="validatePrice(this)" class="block w-full pl-7 pr-12 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="0.00">
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                            <span class="text-gray-500">USD</span>
                        </div>
                    </div>
                    <p id="price-error" class="text-red-500 text-sm text-left mt-1 hidden">Please enter a valid number.</p>
                </div>

                <button onclick="publishProduct()" id="publish-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300 mt-6">
                    Publish
                </button>
            </div>
            
            <!-- Seller post-publish view -->
            <div id="seller-post-publish" class="hidden">
                <h3 class="text-xl font-semibold text-green-600 mb-4">Product Published! âœ…</h3>
                <p class="text-gray-700">Your item has been successfully listed and is now visible to buyers.</p>
            </div>

            <!-- Back to landing page button for both views -->
            <button onclick="showLandingPage()" class="mt-8 text-gray-500 hover:text-gray-900 transition duration-300">
                &larr; Back to Home
            </button>
        </div>

        <!-- ======================= -->
        <!-- Buyer Section -->
        <!-- ======================= -->
        <div id="buyer-page" class="card hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Marketplace</h2>
            <div id="buyer-products" class="space-y-6">
                <!-- Products will be displayed here -->
                <p class="text-gray-600" id="no-products">No products have been published yet.</p>
            </div>
            <button onclick="showLandingPage()" class="mt-8 text-gray-500 hover:text-gray-900 transition duration-300">
                &larr; Back to Home
            </button>
        </div>

        <!-- ======================= -->
        <!-- Payment Options Page -->
        <!-- ======================= -->
        <div id="payment-options-page" class="card hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Select a Payment Method</h2>
            <p id="payment-options-info" class="text-gray-700 mb-4 font-semibold"></p>
            <div class="space-y-4">
                <label for="payment-method" class="block text-left text-gray-700 font-semibold">Payment Method</label>
                <select id="payment-method" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <option value="credit-card">Credit Card</option>
                    <option value="paypal">PayPal (Simulated)</option>
                    <option value="bank-transfer">Bank Transfer (Simulated)</option>
                </select>
                <button onclick="continueToPayment()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300">
                    Continue
                </button>
            </div>
            <button onclick="showBuyerPage()" class="mt-8 text-gray-500 hover:text-gray-900 transition duration-300">
                &larr; Back to Marketplace
            </button>
        </div>

        <!-- ======================= -->
        <!-- Card Details Page (Simulated) -->
        <!-- ======================= -->
        <div id="card-details-page" class="card hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Enter Card Details</h2>
            <p id="card-details-info" class="text-gray-700 mb-4 font-semibold"></p>
            <div class="space-y-4">
                <!-- Card Number Section -->
                <div>
                    <label for="card-number" class="block text-left text-gray-700 font-semibold mb-2">Card Number</label>
                    <input type="text" id="card-number" placeholder="XXXX XXXX XXXX XXXX" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <!-- Expiration Date Section -->
                <div>
                    <label for="card-expiry" class="block text-left text-gray-700 font-semibold mb-2">Expiration Date</label>
                    <input type="text" id="card-expiry" placeholder="MM/YY" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <!-- CVV Section -->
                <div>
                    <label for="card-cvv" class="block text-left text-gray-700 font-semibold mb-2">CVV</label>
                    <input type="text" id="card-cvv" placeholder="XXX" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>

                <p id="payment-error" class="text-red-500 text-sm hidden">Invalid payment details. Please try again.</p>
                
                <button onclick="payNow()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300">
                    Pay Now
                </button>
            </div>
            <button onclick="showPaymentOptionsPage(currentProduct)" class="mt-8 text-gray-500 hover:text-gray-900 transition duration-300">
                &larr; Back to Payment Options
            </button>
        </div>

        <!-- ======================= -->
        <!-- Download Page (Simulated) -->
        <!-- ======================= -->
        <div id="download-page" class="card hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Payment Successful!</h2>
            <p class="text-gray-700 mb-4">Please enter your email to receive your data.</p>
            <div class="space-y-4">
                <input type="email" id="buyer-email" placeholder="Email" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <p id="email-error" class="text-red-500 text-sm hidden">Please enter a valid @gmail.com address.</p>
                <button onclick="getData()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl transition duration-300">
                    Get Data
                </button>
            </div>
            <button onclick="showLandingPage()" class="mt-8 text-gray-500 hover:text-gray-900 transition duration-300">
                &larr; Back to Home
            </button>
        </div>

    </div>

    <!-- Custom Modal/Message Box -->
    <div id="message-modal" class="modal hidden">
        <div class="modal-content">
            <p id="modal-message" class="text-gray-800 text-lg mb-4"></p>
            <button onclick="closeModal()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-xl">
                OK
            </button>
        </div>
    </div>

    <script>
        // Store product data in a simple array for the session
        let publishedProducts = [];
        let currentProduct = null; // To keep track of the product being purchased

        // --- Modal Functions ---
        function showModal(message) {
            document.getElementById('modal-message').textContent = message;
            document.getElementById('message-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('message-modal').classList.add('hidden');
        }


        // --- View Switching Functions ---

        function hideAllSections() {
            document.querySelectorAll('.card').forEach(card => {
                card.classList.add('hidden');
            });
        }

        function showLandingPage() {
            hideAllSections();
            document.getElementById('landing-page').classList.remove('hidden');
        }

        function showSellerLogin() {
            hideAllSections();
            document.getElementById('seller-login').classList.remove('hidden');
            // Reset fields
            document.getElementById('seller-email').value = '';
            document.getElementById('seller-password').value = '';
            document.getElementById('login-error').classList.add('hidden');
        }

        function showSellerDashboard() {
            hideAllSections();
            document.getElementById('seller-dashboard').classList.remove('hidden');
            // Always show the pre-publish view initially
            document.getElementById('seller-pre-publish').classList.remove('hidden');
            document.getElementById('seller-post-publish').classList.add('hidden');
        }

        function showBuyerPage() {
            hideAllSections();
            document.getElementById('buyer-page').classList.remove('hidden');
            renderBuyerProducts();
        }

        function showPaymentOptionsPage(product) {
            currentProduct = product; // Set the current product for the payment flow
            hideAllSections();
            document.getElementById('payment-options-page').classList.remove('hidden');
            // Display product information on the payment options page
            document.getElementById('payment-options-info').textContent = `Purchasing: ${product.name} - $${product.price} USD`;
        }

        function showCardDetailsPage() {
            hideAllSections();
            document.getElementById('card-details-page').classList.remove('hidden');
            document.getElementById('card-details-info').textContent = `Product: ${currentProduct.name} - $${currentProduct.price} USD`;
            document.getElementById('payment-error').classList.add('hidden');
        }

        function showDownloadPage() {
            hideAllSections();
            document.getElementById('download-page').classList.remove('hidden');
            // Reset fields
            document.getElementById('buyer-email').value = '';
            document.getElementById('email-error').classList.add('hidden');
        }

        // --- Seller Login Logic ---

        function handleSellerLogin() {
            const email = document.getElementById('seller-email').value;
            const password = document.getElementById('seller-password').value;
            const errorMsg = document.getElementById('login-error');
            
            // Hardcoded credentials as requested
            if (email === 'rmasood524@gmail.com' && password === 'Ahmad1@1') {
                errorMsg.classList.add('hidden');
                showSellerDashboard();
            } else {
                errorMsg.classList.remove('hidden');
            }
        }

        // --- Seller Dashboard Logic ---

        function validatePrice(input) {
            const priceError = document.getElementById('price-error');
            // Use a regular expression to check for numbers (integers or decimals)
            const price = input.value;
            if (!/^\d*(\.\d{0,2})?$/.test(price) && price !== '') {
                priceError.classList.remove('hidden');
                input.value = price.slice(0, -1); // Remove the invalid character
            } else {
                priceError.classList.add('hidden');
            }
        }

        function publishProduct() {
            const fileInput = document.getElementById('product-file');
            const priceInput = document.getElementById('product-price');
            const priceError = document.getElementById('price-error');
            
            // Check for valid price and file selection
            if (priceInput.value === '' || isNaN(parseFloat(priceInput.value)) || parseFloat(priceInput.value) <= 0) {
                priceError.classList.remove('hidden');
                return;
            }

            if (fileInput.files.length === 0) {
                showModal("Please select a file to publish.");
                return;
            }

            // Get file name and price to simulate publishing
            const fileName = fileInput.files[0].name;
            const price = parseFloat(priceInput.value).toFixed(2);

            // Save the data to our temporary storage
            publishedProducts.push({ name: fileName, price: price });

            // Update the seller's view to show only the published confirmation
            document.getElementById('seller-pre-publish').classList.add('hidden');
            document.getElementById('seller-post-publish').classList.remove('hidden');
        }
        
        // --- Buyer Page Logic ---

        function renderBuyerProducts() {
            const productContainer = document.getElementById('buyer-products');
            productContainer.innerHTML = ''; // Clear previous products

            if (publishedProducts.length === 0) {
                productContainer.innerHTML = '<p class="text-gray-600" id="no-products">No products have been published yet.</p>';
                return;
            }

            publishedProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-gray-100 p-4 rounded-xl flex flex-col sm:flex-row justify-between items-center space-y-2 sm:space-y-0';
                productCard.innerHTML = `
                    <p class="text-gray-800 font-semibold">${product.name}</p>
                    <div class="flex items-center space-x-4">
                        <span class="text-green-600 font-bold text-lg">$${product.price} USD</span>
                        <button onclick='showPaymentOptionsPage(${JSON.stringify(product)})' class="bg-green-500 hover:bg-green-600 text-white text-sm font-bold py-2 px-4 rounded-full transition duration-300">
                            Buy Now
                        </button>
                    </div>
                `;
                productContainer.appendChild(productCard);
            });
        }

        // --- Payment Logic (Simulated) ---
        function continueToPayment() {
            const paymentMethod = document.getElementById('payment-method').value;
            // For this simulation, we'll only show the card details page for credit card.
            // A real app would have different flows for each payment method.
            if (paymentMethod === 'credit-card') {
                showCardDetailsPage();
            } else {
                showModal("This payment method is not supported in this simulation.");
            }
        }

        function payNow() {
            const cardNumber = document.getElementById('card-number').value;
            const cardExpiry = document.getElementById('card-expiry').value;
            const cardCvv = document.getElementById('card-cvv').value;
            const paymentError = document.getElementById('payment-error');

            // Simple simulated validation. A real app would be much more secure.
            if (cardNumber && cardExpiry && cardCvv && cardNumber === '1111222233334444') {
                paymentError.classList.add('hidden');
                showModal("Payment successful! Redirecting to download page.");
                setTimeout(showDownloadPage, 1500); // Wait a bit before showing the next page
            } else {
                paymentError.classList.remove('hidden');
            }
        }

        // --- Data Download Logic (Simulated) ---

        function getData() {
            const emailInput = document.getElementById('buyer-email');
            const email = emailInput.value;
            const emailError = document.getElementById('email-error');

            // Validate that the email ends with @gmail.com as requested
            if (email.endsWith('@gmail.com')) {
                emailError.classList.add('hidden');
                showModal(`Success! A download link for ${currentProduct.name} has been sent to ${email}.`);
            } else {
                emailError.classList.remove('hidden');
            }
        }
    </script>

</body>
</html>
